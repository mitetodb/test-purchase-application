<!DOCTYPE html>
<html th:replace="~{layout :: layout(~{::title}, ~{::main})}"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/extras/spring-security">
<head>
    <title>Dashboard</title>
</head>
<body>
<main>
    <div class="row">
        <div class="col-12">
            <!-- Dashboard Header -->
            <div class="dashboard-header">
                <h2 class="text-gradient">Dashboard</h2>
                <p class="dashboard-welcome">
                    Welcome back, <strong sec:authentication="name"></strong>!
                </p>
            </div>

            <!-- Role Badge -->
            <div class="mb-4">
                <span class="badge bg-gradient-primary" sec:authentication="principal.authorities"></span>
            </div>

            <!-- Statistics Cards - Admin (All Statistics) -->
            <div sec:authorize="hasRole('ADMIN')" class="stats-grid">
                <div class="stat-card">
                    <div class="stat-card-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-card-value" th:text="${totalUsers}">--</div>
                    <div class="stat-card-label">Total Users</div>
                </div>
                <div class="stat-card">
                    <div class="stat-card-icon" style="background: var(--gradient-warm);">
                        <i class="fas fa-shopping-cart"></i>
                    </div>
                    <div class="stat-card-value" th:text="${totalTestPurchases}">--</div>
                    <div class="stat-card-label">Test Purchases</div>
                </div>
                <div class="stat-card">
                    <div class="stat-card-icon" style="background: var(--gradient-success);">
                        <i class="fas fa-user-tie"></i>
                    </div>
                    <div class="stat-card-value" th:text="${totalCustomers}">--</div>
                    <div class="stat-card-label">Customers</div>
                </div>
                <div class="stat-card">
                    <div class="stat-card-icon" style="background: var(--gradient-secondary);">
                        <i class="fas fa-store"></i>
                    </div>
                    <div class="stat-card-value" th:text="${totalShops}">--</div>
                    <div class="stat-card-label">Shops</div>
                </div>
            </div>

            <!-- Statistics Cards - Account Manager & Sales Manager (Customers, Test Purchases, Shops) -->
            <div sec:authorize="hasAnyRole('ACCOUNT_MANAGER', 'SALES_MANAGER')" class="stats-grid">

                <div class="stat-card">
                    <div class="stat-card-icon" style="background: var(--gradient-warm);">
                        <i class="fas fa-shopping-cart"></i>
                    </div>
                    <div class="stat-card-value" th:text="${totalTestPurchases}">--</div>
                    <div class="stat-card-label">Test Purchases</div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-icon" style="background: var(--gradient-success);">
                        <i class="fas fa-user-tie"></i>
                    </div>
                    <div class="stat-card-value" th:text="${totalCustomers}">--</div>
                    <div class="stat-card-label">Customers</div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-icon" style="background: var(--gradient-secondary);">
                        <i class="fas fa-store"></i>
                    </div>
                    <div class="stat-card-value" th:text="${totalShops}">--</div>
                    <div class="stat-card-label">Shops</div>
                </div>
            </div>

            <!-- Statistics Cards - Customer & Mystery Shopper (Shops only) -->
            <div sec:authorize="hasAnyRole('CUSTOMER', 'MYSTERY_SHOPPER')" class="stats-grid">

                <div class="stat-card">
                    <div class="stat-card-icon" style="background: var(--gradient-secondary);">
                        <i class="fas fa-store"></i>
                    </div>
                    <div class="stat-card-value" th:text="${totalShops}">--</div>
                    <div class="stat-card-label">Shops</div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions">

                <!-- Admin Quick Actions -->
                <div sec:authorize="hasRole('ADMIN')">
                    <h4><i class="fas fa-bolt me-2"></i>Admin Quick Actions</h4>
                    <div class="action-cards">
                        <div class="action-card" onclick="window.location.href='/users'">
                            <div class="action-card-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <h5>Manage Users</h5>
                            <p>View and manage all system users, roles, and permissions.</p>
                            <a th:href="@{/users}" class="btn btn-primary btn-sm">
                                <i class="fas fa-arrow-right me-1"></i> Open
                            </a>
                        </div>

                        <div class="action-card" onclick="window.location.href='/testpurchases'">
                            <div class="action-card-icon">
                                <i class="fas fa-shopping-cart"></i>
                            </div>
                            <h5>Test Purchases</h5>
                            <p>View and manage all test purchases in the system.</p>
                            <a th:href="@{/testpurchases}" class="btn btn-primary btn-sm">
                                <i class="fas fa-arrow-right me-1"></i> Open
                            </a>
                        </div>

                        <div class="action-card" onclick="window.location.href='/customers'">
                            <div class="action-card-icon">
                                <i class="fas fa-user-tie"></i>
                            </div>
                            <h5>Manage Customers</h5>
                            <p>View and manage customer accounts and information.</p>
                            <a th:href="@{/customers}" class="btn btn-primary btn-sm">
                                <i class="fas fa-arrow-right me-1"></i> Open
                            </a>
                        </div>

                        <div class="action-card" onclick="window.location.href='/shops'">
                            <div class="action-card-icon">
                                <i class="fas fa-store"></i>
                            </div>
                            <h5>Manage Shops</h5>
                            <p>View and manage shop information and settings.</p>
                            <a th:href="@{/shops}" class="btn btn-primary btn-sm">
                                <i class="fas fa-arrow-right me-1"></i> Open
                            </a>
                        </div>

                    </div>
                </div>

                <!-- Account Manager Quick Actions -->
                <div sec:authorize="hasRole('ACCOUNT_MANAGER')">
                    <h4><i class="fas fa-briefcase me-2"></i>Account Management</h4>
                    <div class="action-cards">

                        <div class="action-card" onclick="window.location.href='/testpurchases'">
                            <div class="action-card-icon">
                                <i class="fas fa-shopping-cart"></i>
                            </div>
                            <h5>Test Purchases</h5>
                            <p>Monitor and manage test purchase orders.</p>
                            <a th:href="@{/testpurchases}" class="btn btn-primary btn-sm">
                                <i class="fas fa-arrow-right me-1"></i> Open
                            </a>
                        </div>

                        <div class="action-card" onclick="window.location.href='/customers'">
                            <div class="action-card-icon">
                                <i class="fas fa-user-tie"></i>
                            </div>
                            <h5>Manage Customers</h5>
                            <p>View and manage customer accounts and relationships.</p>
                            <a th:href="@{/customers}" class="btn btn-primary btn-sm">
                                <i class="fas fa-arrow-right me-1"></i> Open
                            </a>
                        </div>

                        <div class="action-card" onclick="window.location.href='/shops'">
                            <div class="action-card-icon">
                                <i class="fas fa-store"></i>
                            </div>
                            <h5>Shops</h5>
                            <p>View shop information and performance metrics.</p>
                            <a th:href="@{/shops}" class="btn btn-primary btn-sm">
                                <i class="fas fa-arrow-right me-1"></i> Open
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Sales Manager Quick Actions -->
                <div sec:authorize="hasRole('SALES_MANAGER')">
                    <h4><i class="fas fa-chart-line me-2"></i>Sales Management</h4>
                    <div class="action-cards">
                        <div class="action-card" onclick="window.location.href='/testpurchases'">
                            <div class="action-card-icon">
                                <i class="fas fa-shopping-cart"></i>
                            </div>
                            <h5>Test Purchases</h5>
                            <p>View and manage test purchase orders and sales data.</p>
                            <a th:href="@{/testpurchases}" class="btn btn-primary btn-sm">
                                <i class="fas fa-arrow-right me-1"></i> Open
                            </a>
                        </div>

                        <div class="action-card" onclick="window.location.href='/customers'">
                            <div class="action-card-icon">
                                <i class="fas fa-user-tie"></i>
                            </div>
                            <h5>Manage Customers</h5>
                            <p>View and manage customer accounts and relationships.</p>
                            <a th:href="@{/customers}" class="btn btn-primary btn-sm">
                                <i class="fas fa-arrow-right me-1"></i> Open
                            </a>
                        </div>

                        <div class="action-card" onclick="window.location.href='/shops'">
                            <div class="action-card-icon">
                                <i class="fas fa-store"></i>
                            </div>
                            <h5>Shops</h5>
                            <p>View shop information and performance metrics.</p>
                            <a th:href="@{/shops}" class="btn btn-primary btn-sm">
                                <i class="fas fa-arrow-right me-1"></i> Open
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Customer Quick Actions -->
                <div sec:authorize="hasRole('CUSTOMER')">
                    <h4><i class="fas fa-shopping-bag me-2"></i>My Test Purchases</h4>
                    <div class="action-cards">
                        <div class="action-card" onclick="window.location.href='/testpurchases'">
                            <div class="action-card-icon">
                                <i class="fas fa-shopping-cart"></i>
                            </div>
                            <h5>View Test Purchases</h5>
                            <p>View all your test purchase orders and their status.</p>
                            <a th:href="@{/testpurchases}" class="btn btn-primary btn-sm">
                                <i class="fas fa-arrow-right me-1"></i> View All
                            </a>
                        </div>

                        <div class="action-card" onclick="window.location.href='/testpurchases/add'">
                            <div class="action-card-icon">
                                <i class="fas fa-plus-circle"></i>
                            </div>
                            <h5>Create New Test Purchase</h5>
                            <p>Submit a new test purchase order.</p>
                            <a th:href="@{/testpurchases/add}" class="btn btn-success btn-sm">
                                <i class="fas fa-plus me-1"></i> Create New
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Mystery Shopper Quick Actions -->
                <div sec:authorize="hasRole('MYSTERY_SHOPPER')">
                    <h4><i class="fas fa-user-secret me-2"></i>My Assignments</h4>
                    <div class="action-cards">

                        <div class="action-card" onclick="window.location.href='/testpurchases'">
                            <div class="action-card-icon">
                                <i class="fas fa-shopping-cart"></i>
                            </div>
                            <h5>Test Purchases</h5>
                            <p>View all test purchases assigned to you.</p>
                            <a th:href="@{/testpurchases}" class="btn btn-primary btn-sm">
                                <i class="fas fa-arrow-right me-1"></i> View All
                            </a>
                        </div>
                    </div>
                </div>

            </div>

        </div>
    </div>
</main>
</body>
</html>